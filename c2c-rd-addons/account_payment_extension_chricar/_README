this is modified and ported copy of 5.0 module
